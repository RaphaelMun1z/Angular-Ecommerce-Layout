<section class="lg:px-8 py-8">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Lançamentos</h2>
        <a
            href="#"
            class="text-brand text-sm font-medium hover:underline flex items-center"
            >Ver todos <i class="ph ph-arrow-right ml-1"></i
        ></a>
    </div>

    <!-- 1. ESTADO DE CARREGAMENTO (Skeletons) -->
    @if (loading) {
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 lg:gap-6">
            <!-- Cria um loop fixo para desenhar 5 skeletons -->
            @for (i of [1, 2, 3, 4, 5]; track i) {
                <div class="bg-transparent animate-pulse flex flex-col p-2">
                    <!-- Quadrado da Imagem -->
                    <div class="bg-gray-200 rounded-lg aspect-square mb-4"></div>
                    <!-- Categoria -->
                    <div class="h-2.5 bg-gray-200 rounded w-1/3 mb-2"></div>
                    <!-- Título -->
                    <div class="h-3.5 bg-gray-200 rounded w-full mb-2"></div>
                    <div class="h-3.5 bg-gray-200 rounded w-4/5 mb-4"></div>
                    <!-- Estrelas -->
                    <div class="flex gap-1.5 mb-3">
                        <div class="w-3 h-3 bg-gray-200 rounded-full"></div>
                        <div class="w-3 h-3 bg-gray-200 rounded-full"></div>
                        <div class="w-3 h-3 bg-gray-200 rounded-full"></div>
                        <div class="w-3 h-3 bg-gray-200 rounded-full"></div>
                        <div class="w-3 h-3 bg-gray-200 rounded-full"></div>
                    </div>
                    <!-- Preço -->
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </div>
            }
        </div>
    }

    <!-- 2. ESTADO DE ERRO -->
    @if (error && !loading) {
        <div class="flex flex-col items-center justify-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-200">
            <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-sm mb-4">
                <i class="ph ph-warning-circle text-3xl text-red-500"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800 mb-1">Não foi possível carregar os lançamentos</h3>
            <p class="text-sm text-gray-500 mb-6 text-center max-w-sm">
                Ocorreu um problema ao se conectar com o servidor. Verifique sua conexão ou tente novamente.
            </p>
            <button 
                (click)="carregarProdutos(currentPage)"
                class="px-6 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:border-brand hover:text-brand transition shadow-sm"
            >
                <i class="ph ph-arrows-clockwise mr-1"></i> Tentar Novamente
            </button>
        </div>
    }

    <!-- 3. ESTADO DE SUCESSO -->
    @if (!loading && !error) {
        <!-- Grid de Produtos usando o app-product-card -->
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 lg:gap-6">
            @for (produto of produtosLancamento; track produto.id) {
                <app-product-card [product]="produto"></app-product-card>
            }
        </div>

        <!-- Paginação Numerada Dinâmica -->
        @if (totalPages > 0) {
            <div class="flex justify-center items-center mt-10 space-x-1">
                
                <!-- Botão Voltar -->
                <button
                    (click)="goToPage(currentPage - 1)"
                    [disabled]="currentPage === 0"
                    class="w-8 h-8 flex items-center justify-center rounded-md transition"
                    [ngClass]="currentPage === 0 ? 'text-gray-300 cursor-not-allowed' : 'text-gray-400 hover:text-brand'"
                >
                    <i class="ph ph-caret-left"></i>
                </button>

                <!-- Botões das Páginas Dinâmicos -->
                @for (page of getPagesArray(); track page) {
                    <button
                        (click)="goToPage(page)"
                        class="w-8 h-8 flex items-center justify-center rounded-md transition text-sm font-medium"
                        [ngClass]="page === currentPage ? 'bg-brand text-white font-bold shadow-md' : 'text-gray-500 hover:bg-gray-100'"
                    >
                        {{ page + 1 }}
                    </button>
                }

                <!-- Botão Avançar -->
                <button
                    (click)="goToPage(currentPage + 1)"
                    [disabled]="currentPage === totalPages - 1 || totalPages === 0"
                    class="w-8 h-8 flex items-center justify-center rounded-md transition"
                    [ngClass]="(currentPage === totalPages - 1 || totalPages === 0) ? 'text-gray-300 cursor-not-allowed' : 'text-gray-400 hover:text-brand'"
                >
                    <i class="ph ph-caret-right"></i>
                </button>
                
            </div>
        }
    }
</section>