<article 
    class="bg-transparent group cursor-pointer transition-all duration-300" 
    [ngClass]="viewMode === 'list' ? 'flex flex-col sm:flex-row items-start sm:items-center gap-6 p-4 border border-gray-100 rounded-xl hover:shadow-md' : 'flex flex-col'"
    (click)="onCardClick()"
>
    <!-- Container da Imagem -->
    <div 
        class="relative flex items-center justify-center bg-gray-50 rounded-lg"
        [ngClass]="viewMode === 'list' ? 'w-full sm:w-48 h-48 flex-shrink-0 p-2' : 'w-full aspect-square mb-3 p-4'"
    >
        
        <!-- Variação 1: Tag NOVO -->
        @if (isNovo) {
            <span class="absolute top-2 left-2 bg-blue-500 text-white text-[10px] font-bold px-2 py-1 rounded-full z-10">
                NOVO
            </span>
        }

        <!-- Variação 2: Tag de Desconto Dinâmico -->
        @if (desconto) {
            <span class="absolute top-2 right-2 bg-brand text-white text-[10px] font-bold px-2 py-1 rounded-full z-10">
                -{{ desconto }}%
            </span>
        }

        <img
            [src]="mainImage"
            [alt]="product.titulo"
            class="object-contain max-h-full mix-blend-multiply transition transform group-hover:scale-105"
        />
    </div>

    <!-- Container do Texto -->
    <div [ngClass]="viewMode === 'list' ? 'flex-1 flex flex-col justify-center' : ''">
        <p class="text-[10px] text-gray-400 uppercase tracking-wider mb-1">
            {{ product.categoria?.nome || 'Sem categoria' }}
        </p>

        <!-- Título -->
        <h3 
            class="font-semibold text-gray-800 leading-tight mb-2 group-hover:text-brand transition"
            [ngClass]="viewMode === 'list' ? 'text-lg line-clamp-2' : 'text-sm line-clamp-2'"
        >
            {{ product.titulo }}
        </h3>

        <!-- Descrição (Aparece apenas no modo lista) -->
        @if (viewMode === 'list' && product.descricao) {
            <p class="text-sm text-gray-500 mb-4 line-clamp-2">
                {{ product.descricao }}
            </p>
        }

        <!-- Avaliações -->
        <div class="flex items-center space-x-1 mb-3">
            <div class="flex text-yellow-400 text-xs">
                <i class="ph-fill ph-star"></i>
                <i class="ph-fill ph-star"></i>
                <i class="ph-fill ph-star"></i>
                <i class="ph-fill ph-star"></i>
                <i class="ph-fill ph-star-half"></i>
            </div>
            <span class="text-xs text-gray-400">(45)</span>
        </div>

        <!-- Preços -->
        @if (product.precoPromocional) {
            <div class="flex items-center space-x-2 transition">
                <p class="font-bold text-brand" [ngClass]="viewMode === 'list' ? 'text-xl' : ''">
                    {{ product.precoPromocional | currency: "BRL" }}
                </p>
                <p class="text-xs text-gray-400 line-through">
                    {{ product.preco | currency: "BRL" }}
                </p>
            </div>
        } @else {
            <p class="font-bold text-gray-900 transition" [ngClass]="viewMode === 'list' ? 'text-xl' : ''">
                {{ product.preco | currency: "BRL" }}
            </p>
        }
    </div>
</article>