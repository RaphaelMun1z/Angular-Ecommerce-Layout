<div class="container mx-auto px-4 py-4 max-w-5xl animate-fade-in space-y-8">
    
    <div class="mb-8 border-b border-gray-100 pb-4 flex flex-col md:flex-row md:items-end justify-between gap-4">
        <div>
            <h1 class="text-3xl font-bold text-[#101828]">Lista de Desejos</h1>
            <p class="text-gray-500 mt-1 flex items-center gap-2">
                Você salvou 
                <span class="font-bold text-[#101828]">{{ favorites().length }}</span> 
                {{ favorites().length === 1 ? "item" : "itens" }} em sua lista.
            </p>
        </div>

        @if (favorites().length > 0) {
            <button
                (click)="clearAll()"
                class="group flex items-center gap-2 px-4 py-2 text-sm font-bold text-gray-400 hover:text-[#f45b49] transition-all cursor-pointer bg-transparent border-none outline-none"
            >
                <i class="ph-bold ph-trash group-hover:scale-110 transition-transform"></i>
                Limpar Lista
            </button>
        }
    </div>

    @if (isLoading()) {
        <div class="py-32 flex flex-col items-center justify-center bg-white rounded-3xl border border-gray-100">
            <div class="relative">
                <div class="absolute inset-0 bg-[#f45b49]/20 rounded-full blur-xl animate-pulse"></div>
                <i class="ph-duotone ph-spinner animate-spin text-4xl mb-4 text-[#f45b49] relative z-10"></i>
            </div>
            <p class="font-medium text-sm text-gray-400">Sincronizando favoritos...</p>
        </div>
    } 
    
    @else {
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
            @for (item of favorites(); track item.id; let i = $index) {
                <div
                    class="relative group animate-slide-up"
                    [style.animation-delay]="i * 50 + 'ms'"
                >
                    <div
                        class="absolute inset-0 border-2 border-transparent rounded-2xl pointer-events-none z-10 transition-colors group-hover:border-[#f45b49]/10"
                    ></div>

                    <app-product-card
                        [product]="mapToProduto(item)"
                        [viewMode]="'grid'"
                        class="block h-full"
                    >
                    </app-product-card>

                    <button
                        (click)="removeFavorite(item)"
                        class="absolute top-3 right-3 z-20 w-10 h-10 bg-white text-gray-400 border border-gray-100 rounded-full shadow-sm flex items-center justify-center hover:bg-[#f45b49] hover:text-white hover:border-[#f45b49] transition-all cursor-pointer"
                        title="Remover"
                    >
                        <i class="ph-bold ph-trash text-lg"></i>
                    </button>
                </div>
            } 
            
            @empty {
                <div class="col-span-full py-24 text-center bg-gray-50/50 rounded-3xl border border-dashed border-gray-200">
                    <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-sm">
                        <i class="ph-duotone ph-heart-break text-4xl text-gray-300"></i>
                    </div>
                    <h2 class="text-xl font-bold text-[#101828] mb-2">Sua lista está vazia</h2>
                    <p class="text-sm text-gray-500 mb-8 max-w-xs mx-auto">Salve itens para encontrá-los facilmente depois.</p>
                    <button
                        routerLink="/produtos"
                        class="bg-[#101828] hover:bg-black text-white text-xs font-bold uppercase tracking-widest py-4 px-10 rounded-xl transition-all shadow-lg shadow-[#101828]/20 hover:-translate-y-0.5"
                    >
                        Explorar Produtos
                    </button>
                </div>
            }
        </div>
    }
</div>